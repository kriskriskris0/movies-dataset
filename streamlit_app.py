import pandas as pd
import streamlit as st

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∫–æ–Ω–∫–∏ –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(page_title="–î–∞–Ω–Ω—ã–µ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ –¢–∏—Ç–∞–Ω–∏–∫–∞", page_icon="üö¢")

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ –æ–ø–∏—Å–∞–Ω–∏—è
st.title("üö¢ –î–∞–Ω–Ω—ã–µ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ –¢–∏—Ç–∞–Ω–∏–∫–∞")
st.write(
    """
    –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ –ø–æ —Å–ø–∞—Å–µ–Ω–Ω—ã–º –∏–ª–∏ –ø–æ–≥–∏–±—à–∏–º, –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø—É–Ω–∫—Ç –∏–∑ —Å–ø–∏—Å–∫–∞:
    """
)

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
@st.cache_data
def load_data():
    df = pd.read_csv("/mnt/data/titanic_train [tsKg9Q].csv")  # –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º—É —Ñ–∞–π–ª—É
    return df

df = load_data()

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ (–ø—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é)
st.image("/mnt/data/image.png", caption="–¢–∏—Ç–∞–Ω–∏–∫", use_column_width=True)

# –°–æ–∑–¥–∞–Ω–∏–µ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Å—Ç–∞—Ç—É—Å—É –≤—ã–∂–∏–≤–∞–Ω–∏—è
survived_option = st.selectbox(
    "–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è Survived:",
    options=["–õ—é–±–æ–µ", "–°–ø–∞—Å–µ–Ω—ã", "–ü–æ–≥–∏–±—à–∏–µ"],
)

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
if survived_option == "–°–ø–∞—Å–µ–Ω—ã":
    df_filtered = df[df['Survived'] == 1]
elif survived_option == "–ü–æ–≥–∏–±—à–∏–µ":
    df_filtered = df[df['Survived'] == 0]
else:
    df_filtered = df

# –ü–æ–¥—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ –ø–æ –∫–ª–∞—Å—Å—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
average_age_by_class = df_filtered.groupby('Pclass')['Age'].mean().reset_index()
average_age_by_class.columns = ['–ö–ª–∞—Å—Å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è', '–°—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç']

# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
st.write("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ñ–∏–ª—å—Ç—Ä—É:")
st.dataframe(average_age_by_class, use_container_width=True)

# –í—ã–≤–æ–¥ –æ–±—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
st.write(f"–í—Å–µ–≥–æ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤: {len(df_filtered)}")
st.write(f"–°–ø–∞—Å–µ–Ω–æ: {len(df[df['Survived'] == 1])}")
st.write(f"–ü–æ–≥–∏–±–ª–æ: {len(df[df['Survived'] == 0])}")
